å‚è€ƒé“¾æ¥ï¼š

1.[go-cqhttpå¸®åŠ©ä¸­å¿ƒ](https://docs.go-cqhttp.org/)
éƒ¨åˆ†ç§»åŠ¨å¤§å†…ç½‘æ‰“ä¸å¼€ã€‚å¤§éƒ¨åˆ†é—®é¢˜éƒ½èƒ½åœ¨é‡Œé¢å¾—åˆ°è§£å†³ã€‚

2.[efb-qq-plugin-go-cqhttpé…ç½®æ–‡æ¡£](https://github.com/ehForwarderBot/efb-qq-plugin-go-cqhttp#efb-qq-plugin-go-cqhttp)

3.[efb-qq-go-cqhttpçš„Dockeråœ°å€](https://hub.docker.com/r/phoenixxie/efb-qq-go-cqhttp)

4.[efbå®˜æ–¹æ–‡æ¡£](https://github.com/ehForwarderBot/ehForwarderBot/wiki/Modules-Repository)

5.[go-cqhttpä¸‹è½½](https://github.com/Mrs4s/go-cqhttp/releases/)

6.[efb-filter-middlewareä¸­é—´ä»¶](https://github.com/xzsk2/efb-filter-middleware)

**æœ¬æ–‡å¤šä»¥å›¾å½¢åŒ–ç•Œé¢æ¼”ç¤ºï¼Œå–œæ¬¢å‘½ä»¤è¡Œçš„è‡ªè¡Œæ“ä½œã€‚**



# ä¸€ã€ä¸‹è½½efb-qq-go-cqhttpé•œåƒ
ç™»å½•sshï¼Œè¾“å…¥ä¸‹åˆ—ä»£ç 
```
docker pull phoenixxie/efb-qq-go-cqhttp:latest
```
æˆ–è€…ç›´æ¥å»ç¾¤æ™–æ£€ç´¢ä¸‹è½½ï¼Œurlåœ°å€ç‚¹å‡»[è¿™é‡Œ](https://hub.docker.com/r/phoenixxie/efb-qq-go-cqhttp)
![image](https://user-images.githubusercontent.com/50565072/177001693-7642f1f1-9b61-436c-95ab-b7da799d816e.png)
![image](https://user-images.githubusercontent.com/50565072/177001698-e7714cde-c806-402e-9abb-50c6c7e7a935.png)


# äºŒã€è·å–ç”µæŠ¥æœºå™¨äººtokenå’ŒUID
## 1.åˆ›å»ºæœºå™¨äºº
TGæœç´¢botfatherï¼Œè®¤å‡†å®˜æ–¹è´¦å·
![image](https://user-images.githubusercontent.com/50565072/177001854-a87c40ec-7435-46c2-aef8-1c991b225178.png)

åœ¨å¯¹è¯æ¡†è¾“å…¥/ ç‚¹å‡»
```
/newbot
```

å³å¯åˆ›å»ºæ–°æœºå™¨äºº
æŒ‰ç…§æŒ‡ç¤ºå–åå­—ï¼Œå°±å¥½åƒä½ çš„QQæ˜µç§°å¯ä»¥éšæ—¶ä¿®æ”¹ã€‚

![image](https://user-images.githubusercontent.com/50565072/177001870-21fea189-8f99-4241-bc94-4a07bc5a5b18.png)

æŒ‰ç…§æŒ‡ç¤ºå–æœºå™¨äººå·ï¼Œç±»ä¼¼ä½ çš„QQå·ï¼Œå¿…é¡»ç”¨botç»“å°¾ï¼Œä¸å¯ä¿®æ”¹ã€‚

åˆ›å»ºæˆåŠŸä¼šæ”¶åˆ°è¿™æ ·ä¸€æ¡ä¿¡æ¯ï¼š

![image](https://user-images.githubusercontent.com/50565072/177001884-343cd9de-3ea4-46e5-af3e-7c12002b37b7.png)

ç¬¬äºŒå¤„é©¬èµ›å…‹éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„bot tokenï¼Œè¿™ä¸ªè¯·ä¿å­˜å¥½ï¼Œæ³¨æ„ä¸è¦æ³„éœ²ã€‚
ç‚¹å‡»ç¬¬ä¸€å¤„é©¬èµ›å…‹çš„é“¾æ¥ï¼Œè·³è½¬åˆ°ä½ çš„æœºå™¨äººï¼Œç‚¹å‡»å¼€å§‹ã€‚è¿™æ ·å°±æ·»åŠ å¥½äº†ä½ çš„æœºå™¨äººå•¦ã€‚
## 2.è®¾ç½®æœºå™¨äºº
ç»§ç»­å¯¹botfatherå¯¹è¯
```
/setcommands
```
é€‰æ‹©ä½ çš„bot
ç²˜è´´å¦‚ä¸‹å‘½ä»¤å¹¶å‘é€
```
help - æ˜¾ç¤ºå‘½ä»¤åˆ—è¡¨
link - å°†è¿œç¨‹ä¼šè¯ç»‘å®šåˆ° Telegram ç¾¤ç»„
chat - ç”Ÿæˆä¼šè¯å¤´
info - æ˜¾ç¤ºå½“å‰ Telegram èŠå¤©çš„ä¿¡æ¯
unlink_all - å°†æ‰€æœ‰è¿œç¨‹ä¼šè¯ä»Telegram ç¾¤ç»„è§£ç»‘
update_info - æ›´æ–°å½“å‰ç¾¤ç»„åç§°å’Œå¤´åƒï¼Œå’ŒQQåŒæ­¥
rm - æ’¤å›æŸæ¡æ¶ˆæ¯ã€‚å’ŒQQçš„æ’¤å›æ—¶é—´æ˜¯ä¸€æ ·çš„ï¼Œå…·ä½“ä½¿ç”¨ä¸ºå›å¤è¦æ’¤å›çš„å†…å®¹ï¼Œå‘é€ /rm
extra - æ‰çº¿é‡æ–°ç™»å½•æˆ–å¼ºåˆ¶åˆ·æ–°å¯¹è¯åˆ—è¡¨
```
ä¸botfatherå¯¹è¯
```
/setjoingroups  
```
é€‰æ‹©``enable``ï¼Œæ¥å…è®¸æ‚¨çš„ bot åŠ å…¥ç¾¤ç»„ã€‚


```
/setprivacy 
```
é€‰æ‹©``disable``ï¼Œæ¥ç¦ç”¨éšç§é™åˆ¶ï¼Œä»¥ä½¿å…¶èƒ½è¯»å–ç¾¤ç»„å†…çš„æ‰€æœ‰æ¶ˆæ¯ã€‚

è¿˜å¯ä»¥åœ¨botfatherå¤„ç»™ä½ çš„æœºå™¨äººæ·»åŠ å¤´åƒã€ä¿®æ”¹æ˜µç§°ã€ä¿®æ”¹æè¿°ã€‚

## 3.è·å–UID
ï¼ˆ1ï¼‰å¦‚æœä½ æ˜¯plus messagerç”¨æˆ·ï¼Œç›´æ¥ç‚¹å¼€è®¾ç½®ï¼Œåœ¨ä¸ªäººèµ„æ–™å¡å°±èƒ½ç›´æ¥çœ‹åˆ°idã€‚

ï¼ˆ2ï¼‰å¸¸è§„è·å–æ–¹æ³•ï¼šæœç´¢@get_id_bot ï¼Œè¾“å…¥/startï¼Œå°±èƒ½è·å¾—ä½ çš„ID


# ä¸‰ã€åˆ›å»ºå®¹å™¨
æ³¨ï¼šæ­¤å¤„åªè®²ç¾¤æ™–çš„å®‰è£…æ–¹æ³•ï¼Œéœ€è¦çº¯å‘½ä»¤è¡Œçš„ï¼Œè¯·è‡ªè¡ŒæŸ¥é˜…èµ„æ–™ä¾è‘«èŠ¦ç”»ç“¢ã€‚
## 1.åœ¨ç¾¤æ™–åˆ›å»ºä¸€ä¸ªç›®å½•efb-qq-go-cqhttp
ç”¨äºå­˜æ”¾å¤‡ä»½é…ç½®ç­‰æ•°æ®ï¼Œè¿ç§»é‡è£…çš„æ—¶å€™åªéœ€è¦å¤‡ä»½æ•´ä¸ªefb-qq-go-cqhttpç›®å½•å³å¯ã€‚
ç›®å½•ç»“æ„å¦‚ä¸‹

```
efb-qq-go-cqhttp
â”œâ”€â”€ go-cqhttp
â””â”€â”€ profiles
    â””â”€â”€ default
        â”œâ”€â”€ blueset.telegram
        â”‚   â”œâ”€â”€ config.yaml
        â”œâ”€â”€ config.yaml
        â””â”€â”€ milkice.qq
            â”œâ”€â”€ config.yaml
```

å…·ä½“é…ç½®å†…å®¹è§å‚è€ƒé“¾æ¥ï¼Œæœ¬äººè´´å‡ºçš„ä»…ä¾›å‚è€ƒï¼Œæ¯é¡¹ä»£è¡¨ä»€ä¹ˆä¹Ÿè¯·è‡ªè¡ŒæŸ¥é˜…å®˜æ–¹æ–‡æ¡£è¯´æ˜ã€‚

``/docker/efb-qq-go-cqhttp/profiles/default/milkice.qq/config.yaml``

```
Client: GoCQHttp                      # æŒ‡å®šè¦ä½¿ç”¨çš„ QQ å®¢æˆ·ç«¯ï¼ˆæ­¤å¤„ä¸º GoCQHttpï¼‰
GoCQHttp:
    type: HTTP                        # æŒ‡å®š efb-qq-plugin-go-cqhttp ä¸ GoCQHttp é€šä¿¡çš„æ–¹å¼ ç°é˜¶æ®µä»…æ”¯æŒ HTTP
    access_token:
    api_root: http://127.0.0.1:5700/  # GoCQHttp APIæ¥å£åœ°å€/ç«¯å£
    host: 127.0.0.1                # efb-qq-slave æ‰€ç›‘å¬çš„åœ°å€ç”¨äºæ¥æ”¶æ¶ˆæ¯
    port: 8000                        # åŒä¸Š
```


``/docker/efb-qq-go-cqhttp/profiles/default/blueset.telegram/config.yaml``

```
token: "00000000:AAAAAAAAAA" #å¼•å·å†…è¯·æ›¿æ¢ä¸ºè‡ªå·±çš„bottoken
admins:
  - 111111111 #æ›¿æ¢ä¸ºè‡ªå·±çš„Telegram UID 
request_kwargs:                         #ä¸éœ€è¦è¯·åˆ é™¤ç¬¬4-7è¡Œä»£ç ã€‚æ”¯æŒæ·»åŠ ä»£ç†æ–‡ä»¶ï¼ŒHTTPå’ŒSOCKS5å‡æ”¯æŒï¼Œå…·ä½“æ ¼å¼è¯·è‡ªè¡ŒæŸ¥é˜… https://github.com/ehForwarderBot/efb-telegram-master/wiki/Network-Configuration-and-Proxy
    read_timeout: 6
    connect_timeout: 7
    proxy_url: http://XXX.XXX.XXX:ç«¯å£å·/
#å®éªŒæ€§åŠŸèƒ½ æˆ‘ç…§æŠ„wechatçš„
flags:
  chats_per_page: 20 #é€‰æ‹©/ chatå’Œ/ linkå‘½ä»¤æ—¶æ˜¾ç¤ºçš„èŠå¤©æ¬¡æ•°ã€‚è¿‡å¤§çš„å€¼å¯èƒ½å¯¼è‡´è¿™äº›å‘½ä»¤çš„æ•…éšœ
  network_error_prompt_interval: 100 #æ¯æ”¶åˆ°nä¸ªé”™è¯¯åå†é€šçŸ¥ç”¨æˆ·æœ‰å…³ç½‘ç»œé”™è¯¯çš„ä¿¡æ¯ã€‚ è®¾ç½®ä¸º0å¯ç¦ç”¨å®ƒ
  multiple_slave_chats: true #é»˜è®¤true #å°†å¤šä¸ªè¿œç¨‹èŠå¤©é“¾æ¥åˆ°ä¸€ä¸ªTelegramç»„ã€‚ä½¿ç”¨æœªå…³è”çš„èŠå¤©åŠŸèƒ½å‘é€å’Œå›å¤ã€‚ç¦ç”¨ä»¥è¿œç¨‹èŠå¤©å’Œç”µæŠ¥ç»„ä¸€å¯¹ä¸€é“¾æ¥ã€‚
  prevent_message_removal: true  #å½“ä»é€šé“éœ€è¦åˆ é™¤æ¶ˆæ¯æ—¶ï¼Œå¦‚æœæ­¤å€¼ä¸ºtrueï¼ŒEFBå°†å¿½ç•¥è¯¥è¯·æ±‚ã€‚
  auto_locale: true #è‡ªåŠ¨ä»ç®¡ç†å‘˜çš„æ¶ˆæ¯ä¸­æ£€æµ‹åŒºåŸŸè®¾ç½®ã€‚å¦åˆ™å°†ä½¿ç”¨åœ¨ç¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„åŒºåŸŸè®¾ç½®ã€‚
  retry_on_error: false #åœ¨å‘Telegram Bot APIå‘é€è¯·æ±‚æ—¶å‘ç”Ÿé”™è¯¯æ—¶æ— é™é‡è¯•ã€‚è¯·æ³¨æ„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é‡å¤çš„æ¶ˆæ¯ä¼ é€’ï¼Œå› ä¸ºTelegram Bot APIçš„å“åº”ä¸å¯é ï¼Œå¹¶ä¸”å¯èƒ½æ— æ³•åæ˜ å®é™…ç»“æœ
  send_image_as_file: false #å°†æ‰€æœ‰å›¾ç‰‡æ¶ˆæ¯ä»¥æ–‡ä»¶å‘é€ï¼Œä»¥ç§¯æé¿å…â€†Telegramâ€†å¯¹äºå›¾ç‰‡çš„å‹ç¼©ã€‚
  message_muted_on_slave: "mute" #normal:ä½œä¸ºæ™®é€šä¿¡æ¯å‘é€ç»™Telegram silent:å‘é€ç»™Telegramä½œä¸ºæ­£å¸¸æ¶ˆæ¯ï¼Œä½†æ²¡æœ‰é€šçŸ¥å£°éŸ³ mute:ä¸è¦å‘é€ç»™Telegram
  your_message_on_slave: "silent" #åœ¨ä»å±é€šé“å¹³å°ä¸Šæ”¶åˆ°æ¶ˆæ¯æ—¶çš„è¡Œä¸ºã€‚è¿™å°†è¦†ç›–message_muted_on_slaveä¸­çš„è®¾ç½®ã€‚
  animated_stickers: true #å¯ç”¨å¯¹åŠ¨æ€è´´çº¸çš„å®éªŒæ”¯æŒã€‚æ³¨æ„ï¼šæ‚¨å¯èƒ½éœ€è¦å®‰è£…äºŒè¿›åˆ¶ä¾èµ–â€†``libcairo``â€†æ‰èƒ½å¯ç”¨æ­¤åŠŸèƒ½ã€‚
  send_to_last_chat: true #åœ¨æœªç»‘å®šçš„ä¼šè¯ä¸­å¿«é€Ÿå›å¤ã€‚enabledï¼šå¯ç”¨æ­¤åŠŸèƒ½å¹¶å…³é—­è­¦å‘Šã€‚warnï¼šå¯ç”¨è¯¥åŠŸèƒ½ï¼Œå¹¶åœ¨è‡ªåŠ¨å‘é€è‡³ä¸åŒæ”¶ä»¶äººæ—¶å‘å‡ºè­¦å‘Šã€‚disabledï¼šç¦ç”¨æ­¤åŠŸèƒ½ã€‚
```


``/docker/efb-qq-go-cqhttp/profiles/default/config.yaml``

ä¸­é—´ä»¶æœ‰ä¸å°‘ï¼Œä½†éœ€è¦çš„å®‰è£…ç¯å¢ƒã€æ–‡ä»¶ã€é…ç½®ï¼Œè¯·æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£ã€‚ç›®æµ‹QQåªæœ‰ä¸‹é¢è¿™ä¸€ä¸ªå¯ä»¥ç”¨ã€‚æœ¬æ–‡ä¹Ÿæœ‰éƒ¨åˆ†ä¸¾ä¾‹æè¿°ï¼Œå¯ä»¥å‚è€ƒã€‚
```
master_channel: blueset.telegram
slave_channels:
  - milkice.qq
middlewares:     #æ–°æ‰‹å°ç™½å¾…é˜…è¯»å®Œå…¨æ–‡åå†æŒ‰éœ€æ·»åŠ ï¼Œå¦åˆ™å¯åŠ¨ä¼šæŠ¥é”™ã€‚
#  - xzsk2.filter #æ ¹æ®è‡ªå·±çš„æƒ…å†µå†³å®šæ˜¯å¦å¯ç”¨[ä½¿ç”¨å‚è€ƒ]https://github.com/xzsk2/efb-filter-middleware
```

## 2.åˆ›å»ºå®¹å™¨
åœ¨ç¾¤æ™–çš„dockerå¥—ä»¶é‡Œé¢åŒå‡»ä¸‹è½½å¥½çš„é•œåƒæ–‡ä»¶ã€‚
åˆ›å»ºå®¹å™¨ï¼Œç‚¹å‡»é«˜çº§è®¾ç½®ã€‚

![Snipaste_2022-09-27_15-24-23](https://user-images.githubusercontent.com/50565072/192477074-992d83a2-d7b5-4a62-9b73-4389a1da1d49.png)


å·â†’æ·»åŠ æ–‡ä»¶å¤¹ã€‚
å°†å¯¹åº”ç›®å½•æŒ‚è½½åˆ°``/root/.ehforwarderbot/profiles/default/``å’Œ``/root/go-cqhttp/``å³å¯ã€‚
éå¸¸å»ºè®®æŒ‚è½½``/go-cqhttp``æ–‡ä»¶å¤¹ã€‚å› ä¸ºè¿™é‡Œä¿å­˜çš„æ˜¯go-cqhttpæ–‡ä»¶å’ŒğŸ§ç«¯çš„ç™»å½•ä¿¡æ¯ï¼Œå¦‚æœdocker imageæ›´æ–°ï¼Œä¸”ä½ æœªæŒ‚è½½è¯¥æ–‡ä»¶å¤¹ã€‚é‚£ä¹ˆä½ å°†ä¸¢å¤±ä½ çš„ç™»å½•ä¿¡æ¯ï¼Œå†æ¬¡ç™»å½•åˆ™éœ€è¦é‡æ–°éªŒè¯ï¼Œå®¹æ˜“è§¦å‘é£æ§ã€‚

![Snipaste_2022-09-27_15-31-14](https://user-images.githubusercontent.com/50565072/192477601-2a3e6700-3806-46c5-9924-5e8d28e400a8.png)


# å››ã€ç™»å½•QQ
## 1.å®‰è£…go-cqhttp
è¿è¡Œä¸€æ¬¡dockerï¼ŒæŸ¥çœ‹dockeræ—¥å¿—ã€‚

![Snipaste_2022-09-26_15-31-59](https://user-images.githubusercontent.com/50565072/192477868-0b94a130-860f-4e52-b658-ba7b4b0ae582.png)
![Snipaste_2022-09-26_15-32-12](https://user-images.githubusercontent.com/50565072/192477876-6591ace2-cc90-41c8-ad03-d3877a8800e4.png)

å¦‚æœæç¤ºè¿æ¥githubå¤±è´¥ã€è§£å‹å¤±è´¥ç­‰æŠ¥é”™ï¼Œè¯·æ‰‹åŠ¨ä¸‹è½½å¯¹åº”æ¶æ„çš„[go-cqhttp](https://github.com/Mrs4s/go-cqhttp/releases/)ï¼Œå‹ç¼©åŒ…æ”¾ç½®äº/docker/efb-qq-go-cqhttp/go-cqhttp/æ–‡ä»¶å¤¹å†…ï¼Œä¸è¦è§£å‹ã€‚å†æ¬¡é‡å¯dockerï¼Œè§‚å¯Ÿæ—¥å¿—æ˜¯å¦æ­£å¸¸ï¼Œæ˜¯å¦è§£å‹ç›¸å…³æ–‡ä»¶ã€‚

è¿›å…¥sshï¼Œè¾“å…¥ä¸‹åˆ—ä»£ç ã€‚
```
docker exec -it efb-qq-go-cqhttp ash
cd /root/go-cqhttp
./go-cqhttp
0
```

![Snipaste_2022-09-26_16-23-12](https://user-images.githubusercontent.com/50565072/192479065-94dc234c-2a33-479d-acce-81efd755a52c.png)

## 2.å¡«å†™go-cqhttpé…ç½®æ–‡ä»¶å¹¶é‡æ–°å¯åŠ¨docker

æŸ¥çœ‹nasä¸ŠæŒ‚è½½çš„go-cqhttpæ–‡ä»¶å¤¹æ˜¯å¦äº§ç”Ÿäº†é»˜è®¤é…ç½®æ–‡ä»¶``config.yml``ï¼Œå¡«å†™å¹¶ä¿å­˜\docker\efb-qq-go-cqhttp\go-cqhttp\config.ymlï¼Œå…·ä½“è¯´æ˜æŸ¥çœ‹å‚è€ƒé“¾æ¥1ã€2ã€‚

åªä¿®æ”¹å¦‚ä¸‹éƒ¨åˆ†ï¼Œå…¶ä½™çš„é»˜è®¤é…ç½®ä¸æ‡‚çš„å°±ä¸è¦ä¿®æ”¹ã€‚

```
account:         # è´¦å·ç›¸å…³
  uin: 000000000 # QQ è´¦å·
  password: ''   # QQ å¯†ç ï¼Œä¸ºç©ºæ—¶ä½¿ç”¨æ‰«ç ç™»å½•

message:
  # ä¸ŠæŠ¥æ•°æ®ç±»å‹
  # efb-qq-plugin-go-cqhttp ä»…æ”¯æŒ array ç±»å‹
  post-format: array
  # ä¸ºReplyé™„åŠ æ›´å¤šä¿¡æ¯
  extra-reply-data: true


# é»˜è®¤ä¸­é—´ä»¶é”šç‚¹
default-middlewares: &default
  # è®¿é—®å¯†é’¥ï¼Œå¼ºçƒˆæ¨èåœ¨å…¬ç½‘çš„æœåŠ¡å™¨è®¾ç½®
  access-token: ''

servers:
  # HTTP é€šä¿¡è®¾ç½®
  - http:
      # HTTPç›‘å¬åœ°å€
      address: 0.0.0.0:5700
      # åå‘ HTTP è¶…æ—¶æ—¶é—´, å•ä½ç§’
      # æœ€å°å€¼ä¸º 5ï¼Œå°äº 5 å°†ä¼šå¿½ç•¥æœ¬é¡¹è®¾ç½®
      timeout: 5
      middlewares:
        <<: *default # å¼•ç”¨é»˜è®¤ä¸­é—´ä»¶
      # åå‘ HTTP POST åœ°å€åˆ—è¡¨
      post:
        - url: 'http://127.0.0.1:8000' # åœ°å€
          secret: ''                   # å¯†é’¥ä¿æŒä¸ºç©º
```

ä¿å­˜åé‡æ–°å¯åŠ¨dockerã€‚

## 3.ç™»å½•QQ

è¿›å…¥sshï¼Œè¾“å…¥ä¸‹åˆ—ä»£ç ã€‚æ ¹æ®æç¤ºè¿›è¡Œç™»é™†æ“ä½œã€‚

```
docker exec -it efb-qq-go-cqhttp ash
cd /root/go-cqhttp
./go-cqhttp
```

ç™»é™†æˆåŠŸåï¼Œæ–‡ä»¶å¤¹å‡ºç°å¦‚ä¸‹å…¨éƒ¨æ–‡ä»¶ã€‚

![Snipaste_2022-09-27_17-29-33](https://user-images.githubusercontent.com/50565072/192489608-a6c9fd84-5366-42c7-9a9c-909e23229530.png)

å¦‚æœéœ€è¦é‡æ–°æ›´æ¢è´¦å·ä¹‹ç±»çš„æ“ä½œï¼Œä¿ç•™é€‰ä¸­çš„å‡ ä¸ªæ–‡ä»¶ï¼Œå…¶ä½™å…¨éƒ¨åˆ é™¤ï¼Œé‡æ–°è¿›è¡Œç™»å½•æ“ä½œå³å¯ã€‚

## æ³¨æ„äº‹é¡¹ï¼š

1.å¦‚æœç«¯å£å†²çªéœ€è¦å¯¹å‡ ä¸ªé…ç½®æ–‡ä»¶å‡è¿›è¡Œç›¸åº”ä¿®æ”¹ã€‚


2.å…³äºæ»‘æ¡éªŒè¯ç ç™»å½•ï¼š

è¯¥ç™»å½•æ–¹å¼ä¸ºé»˜è®¤é€‰æ‹©ï¼Œä½†è¿‘æœŸå‡ºç°äº†ç™»é™†å¤±è´¥çš„é—®é¢˜ã€‚å¦‚æœä½ å‡ºç°äº†å›¾ä¸­çš„æç¤ºï¼Œè¯·é€‰æ‹©æ‰«ç ç™»å½•ã€‚

![image](https://user-images.githubusercontent.com/50565072/207818823-626c0d0f-e38e-4a0f-999d-1f83ceaeb295.png)

3.å…³äºæ‰«ç ç™»å½•ï¼šéœ€è¦æ‰‹åŠ¨é€‰æ‹©ç™»å½•æ–¹å¼ä¸ºæ‰«ç ç™»å½•ã€‚

è‹¥dockerçš„å®¿ä¸»æœºå’Œæ‰‹æœºä¸å¤„äºåŒä¸€ä¸ªå±€åŸŸç½‘ï¼Œå¯†ç ç•™ç©ºçš„æ‰«ç ç™»å½•ä¼šå¤±è´¥ã€‚


![Snipaste_2022-09-26_16-37-28](https://user-images.githubusercontent.com/50565072/192487005-5f7978ad-da88-45bb-a8d0-92f6d6a9f96f.png)

è‹¥æ‰«ç ç™»å½•é‡åˆ°æç¤ºï¼šå½“å‰è®¾å¤‡ç½‘ç»œä¸ç¨³å®šæˆ–å¤„äºå¤æ‚ç½‘ç»œç¯å¢ƒï¼Œä¸ºäº†ä½ çš„å¸å·å®‰å…¨ï¼Œå»ºè®®å°†ä¸¤ä¸ªè®¾å¤‡è¿æ¥åŒä¸€ç½‘ç»œæˆ–å°†è¢«æ‰«æè®¾å¤‡è¿æ¥ä½ çš„æ‰‹æœºçƒ­ç‚¹åï¼Œé‡æ–°æ‰«ç ç™»å½•ã€‚

![image](https://img-blog.csdnimg.cn/cd4bdb954093417facb8a16fe5937590.png)

å¯ä»¥é¦–å…ˆæŸ¥çœ‹[å¯¹åº”issue](https://github.com/Mrs4s/go-cqhttp/issues/1469) ï¼Œé‡Œé¢æåˆ°åŒ…æ‹¬ï¼šæ‰‹æœºè¿æ¥æœåŠ¡å™¨çš„ä»£ç†è¿›è¡Œæ‰«ç ã€ä½¿ç”¨çˆ±åŠ é€Ÿç­‰appæŒ‚åˆ°æœåŠ¡å™¨æ‰€åœ¨åŸå¸‚â€¦â€¦å¯ä»¥è‡ªè¡Œå°è¯•ã€‚

æœ¬äººæä¾›çš„è§£å†³æ–¹æ³•æ˜¯ï¼š

ï¼ˆ1ï¼‰æœ‰æ¡ä»¶çš„è¿›è¡Œå±€åŸŸç½‘æ‰«ç ï¼Œæœ€ç®€å•ç²—æš´ã€‚

ï¼ˆ2ï¼‰æ²¡æœ‰æ¡ä»¶çš„åœ¨windowsç¯å¢ƒç™»å½•go-cqhttpï¼Œåœ¨[go-cqhttpçš„releaseç•Œé¢](https://github.com/Mrs4s/go-cqhttp/releases/)é€‰æ‹©windowså¯¹åº”å®¢æˆ·ç«¯ä¸‹è½½å¹¶æ‰“å¼€ã€‚æŒ‰ç…§å‰é¢çš„é…ç½®æ–‡ä»¶å†™å¥½config.yamlï¼Œè¿›è¡Œç™»å½•ã€‚å¤åˆ¶ç”µè„‘æ–‡ä»¶å¤¹é‡Œé¢çš„device.jsonã€session.tokenåˆ°æœåŠ¡å™¨go-cqhttpæ‰€åœ¨æ–‡ä»¶å¤¹ã€‚


4.å¦‚æœä¸­é€”é€€å‡ºäº†ï¼Œå†è¿›go-cqhttpå‡ºç°è¢«å ç”¨æç¤ºï¼Œä¸ç”¨åå¤åˆ é™¤ç™»é™†æ–‡ä»¶ï¼Œç”¨ä¸‹é¢çš„ä»£ç ã€‚

![Snipaste_2022-09-26_18-14-23](https://user-images.githubusercontent.com/50565072/192490691-85fbb850-976c-4b02-a502-9ed8fe9e53b3.png)

```
kill -9 $( ps -e|grep go-cqhttp |awk '{print $1}') 
./go-cqhttp
```

5.è‹¥ç¡®å®šé…ç½®æ–‡ä»¶å’Œç«¯å£æ²¡æœ‰ä»»ä½•çš„é”™è¯¯ï¼Œä½†ç™»é™†æ—¶go-cqhttpåå¤å‡ºç°å¦‚ä¸‹é”™è¯¯

```
[2022-09-26 18:29:00] [WARNING]: ä¸ŠæŠ¥ Event æ•°æ®åˆ° http://127.0.0.1:8000 å¤±è´¥: Post "http://127.0.0.1:8000": dial tcp 127.0.0.1:8000: connect: connection refused å°†è¿›è¡Œç¬¬ 1 æ¬¡é‡è¯• 
[2022-09-26 18:29:01] [WARNING]: ä¸ŠæŠ¥ Event æ•°æ®åˆ° http://127.0.0.1:8000 å¤±è´¥: Post "http://127.0.0.1:8000": dial tcp 127.0.0.1:8000: connect: connection refused å°†è¿›è¡Œç¬¬ 2 æ¬¡é‡è¯• 
[2022-09-26 18:29:03] [WARNING]: ä¸ŠæŠ¥ Event æ•°æ®åˆ° http://127.0.0.1:8000 å¤±è´¥: Post "http://127.0.0.1:8000": dial tcp 127.0.0.1:8000: connect: connection refused å°†è¿›è¡Œç¬¬ 3 æ¬¡é‡è¯• 
[2022-09-26 18:29:04] [WARNING]: ä¸ŠæŠ¥ Event æ•°æ® {"post_type":"meta_event","meta_event_type":"heartbeat","time":1664188140,"self_id":QQå·,"status":{"app_enabled":true,"app_good":true,"app_initialized":true,"good":true,"online":true,"plugins_good":null,"stat":{"packet_received":317,"packet_sent":306,"packet_lost":0,"message_received":2,"message_sent":0,"last_message_time":1664188130,"disconnect_times":0,"lost_times":0}},"interval":5000}
 åˆ° http://127.0.0.1:8000 å¤±è´¥: Post "http://127.0.0.1:8000": dial tcp 127.0.0.1:8000: connect: connection refused åœæ­¢ä¸ŠæŠ¥ï¼šå·²è¾¾é‡è¯•ä¸Šé™ 
 ```
 dockeræ—¥å¿—ä¹Ÿæç¤º
 
```
Exception: We're unable to communicate with CoolQ Client.
Please check the connection and credentials provided.
Unable to connect to CoolQ Client!Error Message:
HTTP request failed
During handling of the above exception, another exception occurred:
```
å¯èƒ½æ˜¯æœºå™¨æ€§èƒ½ä¸å¤Ÿå¯åŠ¨å¤ªæ…¢ï¼Œè¿›å…¥sshï¼Œè¾“å…¥ä¸‹åˆ—ä»£ç ã€‚

```
docker exec -it efb-qq-go-cqhttp ash
cd /root/go-cqhttp
ehforwarderbot
```
å¦‚æœæç¤ºæ­£å¸¸è¯†åˆ«ï¼Œä¸”é…ç½®çš„telegramæœºå™¨äººèƒ½æ­£å¸¸æ”¶åˆ°QQä¿¡æ¯ï¼Œé‚£ä¹ˆå°è¯•è¿›å…¥dockerä¿®æ”¹``start.sh``æ–‡ä»¶ã€‚

æˆ‘ä½¿ç”¨winscpåœ¨å¦‚ä¸‹å›¾ä½ç½®æ‰¾åˆ°äº†ç›¸å…³æ–‡ä»¶ä¿®æ”¹ã€‚ä¸çŸ¥é“æ˜¯å“ªä¸ªdockeræ–‡ä»¶å¤¹å¯ä»¥é€šè¿‡åˆ›å»ºæ—¶é—´çš„æ–°æ—§åˆ¤æ–­ï¼Œä¸¤ä¸ªåå­—ç›¸ä¼¼çš„æ–‡ä»¶å¤¹å‡è¿›è¡Œäº†ä¿®æ”¹ã€‚

![Snipaste_2022-09-27_17-38-49](https://user-images.githubusercontent.com/50565072/192492755-5d2e5d46-8108-4618-a1a7-16215e7051da.png)

![Snipaste_2022-09-27_17-39-42](https://user-images.githubusercontent.com/50565072/192492620-78ff94de-4f23-4ba1-a94e-97cbc1f93ae0.png)

ä¿®æ”¹åé‡å¯dockerï¼Œå‘ç°dockeræ—¥å¿—å·²ç»æ­£å¸¸ï¼Œä¸å†éœ€è¦æ‰‹åŠ¨å¯åŠ¨efbã€‚

![Snipaste_2022-09-27_17-43-38](https://user-images.githubusercontent.com/50565072/192493033-936f6d92-c79a-45a4-9a30-44843b40e8e2.png)

# äº”ã€ç™»å½•åç©æ³•
## 1.åˆ†ç»„
ç™»å½•åæœºå™¨äººä¼šå¼€å§‹å¸®ä½ æ¥æ”¶ä¿¡æ¯ï¼Œç„¶è€Œä¸ç®¡æ˜¯ç¾¤ç»„è¿˜æ˜¯ç§èŠï¼Œéƒ½ä¼šæ¨é€ä¿¡æ¯åˆ°è¿™ä¸€ä¸ªæœºå™¨äººï¼Œä¿¡æ¯éå¸¸ç¹æ‚ï¼Œä¸åˆ©äºè¾¨è®¤ï¼Œæ‰€ä»¥å¾ˆæœ‰å¿…è¦è¿›è¡Œåˆ†ç»„ã€‚
###### ï¼ˆ1ï¼‰åˆ›å»ºç¾¤ç»„

![image](https://user-images.githubusercontent.com/50565072/177025778-080408a1-2922-46d6-9923-e4b0159c4a83.png)


ç¾¤ç»„åå­—è®¾ç½®ï¼šå¦‚æœæ˜¯å•ä¸ªç§èŠæˆ–è€…å•ä¸ªç¾¤èŠï¼Œéšä¾¿è®¾ç½®ä¸€ä¸ªåå­—ï¼Œä¹‹åå¯ä»¥é€šè¿‡æœºå™¨äººå‘½ä»¤åŒæ­¥ä¿¡æ¯ï¼Œä¸ç”¨è‡ªå·±æŒ¨ä¸ªè®¾ç½®ã€‚å¦‚æœæ˜¯æƒ³å½’ç±»ï¼Œä¸€ä¸ªç¾¤ç»„å…³è”å¾ˆå¤šèŠå¤©å¯¹è¯ï¼Œå°±æŒ‰éœ€è®¾ç½®ã€‚ä¾‹å¦‚ï¼šâ€œæ¸¸æˆâ€ã€â€œåŒäº‹â€ã€‚

è®°å¾—æ¯ä¸ªç¾¤ç»„éƒ½å¿…é¡»æŠŠè‡ªå·±åˆ›å»ºçš„æœºå™¨äººæ‹‰è¿›ç¾¤ã€‚

###### ï¼ˆ2ï¼‰è¿›è¡Œç­›é€‰åˆ†ç»„
åœ¨æœºå™¨äººå¯¹è¯ç•Œé¢æ“ä½œï¼š
å¯ä»¥é’ˆå¯¹å·²ç»ç»™ä½ å‘é€ä¿¡æ¯çš„è´¦æˆ·ï¼Œç›´æ¥å·¦æ»‘å›å¤ï¼Œè¾“å…¥/linkï¼Œå‘é€ï¼Œé€‰æ‹©linkï¼Œç„¶åé€‰æ‹©ä½ åˆ›å»ºå¥½çš„ç¾¤ç»„å³å¯ã€‚
ä¸€ä¸ªç¾¤ç»„å¯ä»¥linkå¤šä¸ªQQè´¦æˆ·ï¼Œè¾¾åˆ°åˆ†ç»„åŠŸèƒ½ã€‚

![image](https://user-images.githubusercontent.com/50565072/177025791-6439baa6-4e5f-4b00-afb4-97b9b30ed5cf.png)


###### ï¼ˆ3ï¼‰æ›´æ–°ç¾¤ç»„ä¿¡æ¯
å½“ä½ çš„ç¾¤ç»„åªç»‘å®šäº†ä¸€ä¸ªQQç§èŠæˆ–è€…ç¾¤ç»„æ—¶ï¼Œå¯ä»¥åœ¨ç¾¤ç»„ä¸­è¾“å…¥/update_infoï¼Œå³å¯è‡ªåŠ¨åŒæ­¥QQå¤´åƒã€æ˜µç§°ã€ç¾¤ç»„æˆå‘˜ï¼ˆåœ¨ç®€ä»‹ä¸­ï¼‰ã€‚è¿™é¡¹åŠŸèƒ½éœ€è¦ç»™æœºå™¨äººç®¡ç†å‘˜æƒé™ã€‚
## 2.ä¸­é—´ä»¶è®¾ç½®
æœ¬æ–‡åªä¸¾ä¾‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå…¶ä½™çš„è¿˜è¯·è‡ªå·±æŸ¥é˜…å®˜æ–¹é“¾æ¥ã€‚ä¸å°‘ä¸­é—´ä»¶åªæ˜¯é€‚ç”¨äºå¾®ä¿¡ï¼Œä¸é€‚ç”¨äºQQã€‚ä¸éœ€è¦å¯åŠ¨çš„ä¸­é—´ä»¶ç›´æ¥åœ¨æœ€å‰é¢åŠ ä¸Š#æ³¨é‡Šæ‰å³å¯ã€‚
###### xzsk2.filterï¼šä¿¡æ¯è¿‡æ»¤

[efb-filter-middlewareä¸­é—´ä»¶](https://github.com/xzsk2/efb-filter-middleware)

æ–°å»ºä¸€ä¸ªæ–‡ä»¶config.yamlï¼Œä½ç½®åœ¨``/docker/efb-qq-go-cqhttp/profiles/default/xzsk2.filter``ã€‚æ²¡æœ‰çš„æ–‡ä»¶å¤¹è‡ªå·±åˆ›å»ºã€‚

```
version: 3.46   #éšä¾¿å†™
match_mode: fuzz  
#fuzzæ˜¯å…³é”®å­—å‘½ä¸­å³å¯åŒ¹é…ï¼›exactæ˜¯éœ€è¦å®Œæ•´è¯ç»„ç²¾ç¡®åŒ¹é…
work_mode:
        - black_persons   #é»‘åå•å¥½å‹ï¼Œè¿‡æ»¤ä»–çš„ä¿¡æ¯ã€‚å¦‚æœä½ ä¸æƒ³æ¼æ”¶ç§èŠä¿¡æ¯ï¼Œä¹Ÿä¸€å®šè¦å¯ç”¨è¿™ä¸ªã€‚
        - white_groups    #ç™½åå•ç¾¤ç»„ï¼Œä»…æ¥å—åˆ—è¡¨å†…ç¾¤ç»„çš„ä¿¡æ¯
#white_persons:
#        - libai
white_groups:
        - 1234
        - "*"
        #ç‰¹æ®Šå­—ç¬¦éœ€è¦æ‰“å¼•å·
black_persons:   #å¦‚æœä½ ä¸æƒ³æ¼æ”¶ç§èŠä¿¡æ¯ï¼Œä¹Ÿä¸€å®šè¦å¯ç”¨è¿™ä¸ªã€‚
        - nopppppppp   #å¦‚æœæ²¡æœ‰æƒ³è¿‡æ»¤çš„äººï¼Œå°±å¡«ä¸€ä¸ªå¥½å‹é‡Œé¢æ²¡æœ‰çš„åå­—å§
#black_groups:
#        - testsyou
```
åœ¨/docker/efb-qq-go-cqhttp/profiles/default/config.yamlä¸­æ·»åŠ ä¸‹åˆ—ä»£ç ï¼Œä¿å­˜å¹¶é‡å¯dockerï¼Œæ—¥å¿—å¦‚æ— æŠ¥é”™æ­£å¸¸è¯†åˆ«è¿è¡Œä¸­é—´ä»¶åˆ™æˆåŠŸã€‚
```
- xzsk2.filter   
```
![image](https://user-images.githubusercontent.com/50565072/177003098-3154b5d0-4b7f-4824-92b5-b55ab293c1d6.png)


è¯¥dockerå·²ç»å†…ç½®æ­¤ä¸­é—´ä»¶ï¼Œæ— éœ€å®‰è£…ã€‚
å¦‚æ²¡æœ‰å®‰è£…åˆ™åœ¨å®¹å™¨å†…è¿è¡Œä¸‹åˆ—ä»£ç ã€‚
```
apk update
apk add git
pip3 install git+https://github.com/xzsk2/efb-filter-middleware
```
